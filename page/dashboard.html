<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Admin Dashboard</title>
    <link rel="stylesheet" href="../asset/bootstrap/css/bootstrap.css">
    <link href="../asset/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../asset/style/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">


    <style>
        #tooltip {
            display: none;
            position: absolute;
            top: 70px;
            left: 90px;
            background-color: #333;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
        }

        body {
            color: #ffffff;
            font-family: 'Roboto', sans-serif;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            /* margin-bottom: 5px; */
        }

        canvas {
            margin-top: 2px !important;
            max-height: 300px;
        }

        #chart {
            height: 320px;
        }

        .border {
            border: 1px solid #ddd;
        }
    </style>

</head>

<body>

    <div id="dashboardContainer">

        <nav class="navbar navbar-expand-lg navbar-light border-bottom" style="background-color: #edf2f9;">

            <div class="logo" style="width: 300px; margin-left: 5px;">
                <h1 class="text-center text-addmin my-4 text-uppercase">Admin Portfolio</h1>
            </div>

            <div class="container-fluid">
                <button id="sidebarToggle" class="btn btn-outline-secondary d-xl-none me-2">
                    <i class="bi bi-list"></i>
                </button>

                <h2 class="welcome" style="font-size: 30px;">Welcome admin <span id="adminName"
                        style="font-weight: bold;"></span>!</h2>
                <ul class="navbar-nav ms-auto d-flex align-items-center">
                    <li class="pe-2">
                        <a href="../ronaldo-master/ronaldo-master/index.html" target="_blank"
                            class="btn btn-dark rounded-5" style="height: 30px; line-height: 10px;"><i
                                class="bi bi-box-arrow-up-right"></i> Open Site</a>
                    </li>

                    <li class="nav-item pe-2">
                        <a class="nav-link" href="#" id="notificationBtn">
                            <i class="bi bi-bell fs-5"></i>
                        </a>
                    </li>
                    <li class="nav-item align-items-center d-flex">
                        <a href="profileAdmin.html" id="avatar"><img id="avtadmin" src="#" alt=""></a>
                    </li>
                </ul>
            </div>
        </nav>
        <div id="sidebar" class="sidebar bg-primary text-white p-3 d-flex flex-column" style="width: 250px;">
            <!-- Close Sidebar Button for Smaller Screens -->
            <button id="closeSidebar" class="btn btn-light d-xl-none mb-3 btn-close-bar">
                <i class="bi bi-chevron-left"></i>
            </button>

            <!-- Sidebar Navigation Links -->
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active text-white" href="dashboard.html" data-section="dashboard">
                        <i class="bi bi-grid me-2"></i> Dashboard
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="contact.html" data-section="contact">
                        <i class="bi bi-envelope me-2"></i> Contact
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="education.html" data-section="education">
                        <i class="bi bi-mortarboard me-2"></i> Education
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="skill.html" data-section="skills">
                        <i class="bi bi-briefcase me-2"></i> Skills
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="project.html" data-section="projects">
                        <i class="bi bi-credit-card-2-back me-2"></i> Projects
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="sofware.html" data-section="software">
                        <i class="bi bi-plugin me-2"></i> Software
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="experience.html" data-section="experience">
                        <i class="bi bi-briefcase me-2"></i> Experience
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="language.html" data-section="language">
                        <i class="bi bi-translate me-2"></i> Language
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="profile.html" data-section="profile">
                        <i class="bi bi-person me-2"></i> Profile
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-white" href="bio.html" data-section="biography">
                        <i class="bi bi-file-text me-2"></i> Biography
                    </a>
                </li>
            </ul>
        </div>


        <div class="main-content">


            <main class="container-fluid py-4">
                <div id="dashboardContent">
                    <h3 id="sectionTitle" class="mb-3 text-db sec-title">Dashboard</h3>

                    <div class="row g-3">
                        <div class="col-12">
                            <div class="row mb-2">
                                <!-- Card: Total View -->
                                <div class="col-md-3">
                                    <div class="card card-view text-center shadow-sm">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-center mb-3">
                                                <i class="fas fa-eye icon-container"></i>
                                                <h6 class="card-title mb-0">Total View</h6>
                                            </div>
                                            <p class="card-text text-muted">Number of viewer portfolio</p>
                                            <h2 class="card-text" id="tview">0</h2>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Total Contact -->
                                <div class="col-md-3">
                                    <div class="card card-view text-center shadow-sm">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-center mb-3">
                                                <i class="fas fa-address-book icon-container"></i>
                                                <h6 class="card-title mb-0">Total Contact</h6>
                                            </div>
                                            <p class="card-text text-muted">Total number of contacts</p>
                                            <h2 class="card-text" id="tcontact">0</h2>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Total Own Project -->
                                <div class="col-md-3 ">
                                    <div class="card card-view text-center shadow-sm">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-center mb-3">
                                                <i class="fas fa-tasks icon-container"></i>
                                                <h6 class="card-title mb-0">Total Own Project</h6>
                                            </div>
                                            <p class="card-text text-muted">Number of total own projects</p>
                                            <h2 class="card-text" id="tproject">0</h2>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card: Total Blog -->
                                <div class="col-md-3 ">
                                    <div class="card card-view text-center shadow-sm">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-center mb-3">
                                                <i class="fas fa-blog icon-container"></i>
                                                <h6 class="card-title mb-0">Total Blog</h6>
                                            </div>
                                            <p class="card-text text-muted">Number of total blogs</p>
                                            <h2 class="card-text" id="tblog">0</h2>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-12">
                            <div class="row g-4">
                                <div class="col-6 mt-0">
                                    <div class="text-chart bg-white text-primary p-3"
                                        style="text-align: center; margin-top: 20px; font-weight: bold; border-radius: 10px 10px 0px 0;">
                                        Charts page
                                    </div>
                                    <div class="bg-white rounded-bottom-3" id="chart"
                                        style="height: 350px;  border-radius: 0px 0px 10px 10;">

                                    </div>
                                </div>
                                <div class="col-6 mt-0">
                                    <div class="text-chart bg-white text-primary p-3"
                                        style="text-align: center; margin-top: 20px; font-weight: bold; border-radius: 10px 10px 0px 0;">
                                        Skill Product
                                    </div>
                                    <div class=" bg-white rounded-bottom-3" id="chart1"
                                        style="height: 350px;  border-radius: 0px 0px 10px 10;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row g-3">

                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../asset/bootstrap/js/bootstrap.bundle.js"></script>
    <script src="../asset/js/javascript.js"></script>
    <script>
        let totalEducation, totalProject, totalSkills, totalExperience, totalLanguage;


        function getdataed() {
            fetch('https://mps7.chandalen.dev/api/educations')
                .then(res => res.json())
                .then(json => {
                    totalEducation = json.data.length;
                    //console.log(totalEducation)
                })

        }

        function gettatolExperience() {
            fetch('https://mps7.chandalen.dev/api/experiences')
                .then(res => res.json())
                .then(json => {
                    totalExperience = json.data.length;

                })

        }

        function gettatolLanguage() {
            fetch('https://mps7.chandalen.dev/api/languages')
                .then(res => res.json())
                .then(json => {
                    totalLanguage = json.data.length;

                })

        }

        function gettatolSkills() {
            fetch('https://mps7.chandalen.dev/api/skills')
                .then(res => res.json())
                .then(json => {
                    totalSkills = json.data.length;
                    skills = `
                {
                   value: ${json.data.name},
                   name: '${json.data.percent}',
                   itemStyle: {
                   color: rgbaColor(themeColors.primary, 0.5)
                  }
                    `;


                })


        }

        function gettatolProject() {
            fetch('https://mps7.chandalen.dev/api/projects')
                .then(res => res.json())
                .then(json => {
                    totalProject = json.data.length;

                })

        }
        gettatolProject();
        gettatolSkills();
        gettatolLanguage();
        gettatolExperience();
        getdataed();
        //get index dasbaord
        function getdata() {
            let dashboardData = {
                total_contact: 0,
                total_view: 0,
                total_own_project: 0,
                total_blog: 0,
            };

            fetch(`https://mps7.chandalen.dev/api/dashboard`, {
                method: 'GET',
                headers: {
                    "Accept": "application/json",
                    "Authorization": `Bearer ${token}`
                }
            })
                .then(res => res.json())

                .then(json => {
                    // Save fetched data globally

                    dashboardData = json.data;
                    document.getElementById('tview').innerText = dashboardData.total_view;
                    document.getElementById('tcontact').innerText = dashboardData.total_contact;
                    document.getElementById('tproject').innerText = dashboardData.total_own_project;
                    document.getElementById('tblog').innerText = dashboardData.total_blog;

                    function getThemeColor(name) {
                        const colors = {
                            'gray-100': '#f8f9fa',
                            'gray-200': '#e9ecef',
                            'gray-300': '#dee2e6',
                            'gray-400': '#ced4da',
                            'gray-1100': '#343a40',
                            'primary': '#007bff'
                        };
                        return colors[name] || '#000';
                    }
                    // Chat api data 
                    function getOption() {

                        const months = ['Contact', 'Education', 'Experience', 'Language', 'Project', 'Skills'];
                        const data = [dashboardData.total_contact, totalEducation, totalExperience, totalLanguage, totalProject, totalSkills];
                        return {
                            title: [
                                // { text: 'Skill chart', left: 'center', textStyle: { color: themeColors.gray600 } },
                                // { subtext: 'alignTo: "edge"', left: '50%', top: '85%', textAlign: 'center', subtextStyle: { color: themeColors.gray700 } }
                            ],
                            tooltip: {
                                trigger: 'axis',
                                padding: [7, 10],
                                backgroundColor: getThemeColor('gray-100'),
                                borderColor: getThemeColor('gray-300'),
                                textStyle: {
                                    color: getThemeColor('gray-1100')
                                },
                                borderWidth: 1,
                                transitionDuration: 0,
                                axisPointer: {
                                    type: 'none'
                                }
                            },
                            xAxis: {
                                type: 'category',
                                data: months,
                                axisLine: {
                                    lineStyle: {
                                        color: getThemeColor('gray-300'),
                                        type: 'solid'
                                    }
                                },
                                axisTick: {
                                    show: false
                                },
                                axisLabel: {
                                    color: getThemeColor('gray-400'),
                                    formatter: value => value.substring(0, 10),
                                    margin: 15
                                },
                                splitLine: {
                                    show: false
                                }
                            },
                            yAxis: {
                                type: 'value',
                                axisLabel: {
                                    show: true,
                                    color: getThemeColor('gray-400'),
                                    margin: 15
                                },
                                splitLine: {
                                    show: true,
                                    lineStyle: {
                                        color: getThemeColor('gray-200')
                                    }
                                },
                                axisTick: {
                                    show: false
                                },
                                axisLine: {
                                    show: false
                                },
                                min: 0
                            },
                            series: [{
                                type: 'bar',
                                name: 'Total',
                                data: data,
                                lineStyle: {
                                    color: getThemeColor('primary')
                                },
                                itemStyle: {
                                    color: getThemeColor('primary'),
                                    borderRadius: [3, 3, 0, 0]
                                },
                                showSymbol: false,
                                smooth: false,
                                emphasis: {
                                    scale: true
                                }
                            }],
                            grid: {
                                right: '3%',
                                left: '10%',
                                bottom: '10%',
                                top: '5%'
                            }
                        };
                    }

                    // Initialize the chart
                    const chartDom = document.getElementById('chart');
                    const myChart = echarts.init(chartDom);
                    myChart.setOption(getOption());
                    const themeColors = {
                        primary: '#007bff',
                        secondary: '#6c757d',
                        danger: '#dc3545',
                        warning: '#ffc107',
                        success: '#28a745',
                        info: '#17a2b8',
                        gray600: '#6c757d',
                        gray700: '#495057',
                        gray100: '#f8f9fa',
                        gray300: '#dee2e6',
                        gray1100: '#212529'
                    };

                    function rgbaColor(color, opacity) {
                        return color.replace(')', `, ${opacity})`).replace('rgb', 'rgba');
                    }

                    // Chart Data
                    const data = [

                        {
                            value: 100,
                            name: 'SQL',
                            itemStyle: {
                                color: rgbaColor(themeColors.primary, 0.5)
                            }
                        }, {
                            value: 100,
                            name: 'Oracle',
                            itemStyle: {
                                color: themeColors.danger
                            }
                        }, {
                            value: 100,
                            name: 'OOP',
                            itemStyle: {
                                color: themeColors.primary
                            }
                        }, {
                            value: 100,
                            name: 'Laravel',
                            itemStyle: {
                                color: themeColors.secondary
                            }
                        }, {
                            value: 100,
                            name: 'Bootstrap',
                            itemStyle: {
                                color: themeColors.warning
                            }
                        }, {
                            value: 100,
                            name: 'CSS',
                            itemStyle: {
                                color: rgbaColor(themeColors.warning, 0.8)
                            }
                        }, {
                            value: 100,
                            name: 'Javascript',
                            itemStyle: {
                                color: themeColors.success
                            }
                        }, {
                            value: 100,
                            name: 'JAVA',
                            itemStyle: {
                                color: themeColors.info
                            }
                        }, {
                            value: 100,
                            name: 'HTML',
                            itemStyle: {
                                color: rgbaColor(themeColors.primary, 0.5)
                            }
                        }
                    ];


                    // Chart Initialization
                    const chartElement = document.getElementById('chart1');
                    const chart = echarts.init(chartElement);

                    // Function to get chart options
                    function getOption1() {
                        return {
                            title: [
                                // { text: 'Skill chart', left: 'center', textStyle: { color: themeColors.gray600 } },
                                // { subtext: 'alignTo: "edge"', left: '50%', top: '85%', textAlign: 'center', subtextStyle: { color: themeColors.gray700 } }
                            ],
                            tooltip: {
                                trigger: 'item',
                                padding: [7, 10],
                                backgroundColor: themeColors.gray100,
                                borderColor: themeColors.gray300,
                                textStyle: {
                                    color: themeColors.gray1100
                                },
                                borderWidth: 1,
                                transitionDuration: 0,
                                axisPointer: {
                                    type: 'none'
                                }
                            },
                            series: [{
                                type: 'pie',
                                radius: window.innerWidth < 530 ? '45%' : '60%',
                                center: ['50%', '50%'],
                                data: data,
                                label: {
                                    position: 'outer',
                                    alignTo: 'edge',
                                    edgeDistance: 20,
                                    color: themeColors.gray700
                                },
                                left: '5%',
                                right: '5%',
                                top: 0,
                                bottom: 0
                            }]
                        };
                    }

                    // Set initial chart options
                    chart.setOption(getOption1());

                    // Responsive chart on window resize
                    window.addEventListener('resize', () => {
                        chart.setOption({
                            series: [{
                                radius: window.innerWidth < 530 ? '45%' : '60%'
                            }]
                        });
                    });

                })
        }
        getdata()
        const toggleTooltip = document.getElementById('toggleNavigationTooltip');
        const tooltip = document.getElementById('tooltip');

        toggleTooltip.addEventListener('click', () => {
            tooltip.style.display = tooltip.style.display === 'none' ? 'block' : 'none';
        });
        // Data form caht
    </script>

    <script>
        // Utility functions for theme colors
    </script>
</body>

</html>